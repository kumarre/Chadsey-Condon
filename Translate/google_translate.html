<!-- Code Injection - Header -->
<!-- ----------------------- -->

<!-- create google translate element -->
<script type="text/javascript">
  function googleTranslateElementInit() {
      new google.translate.TranslateElement({pageLanguage: 'en', includedLanguages: 'en,ar,es', layout: google.translate.TranslateElement.InlineLayout.SIMPLE, autoDisplay: false}, 'google_translate_element');
    }
</script>
<!-- initialize element -->
<script type="text/javascript"
  src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>




<!-- Code Injection - Footer -->
<!-- ----------------------- -->

<div id="google_translate_element"></div>

<div id="translation" class="desktop">
  <ul class="translation_links">
    <li><a href="#" class="language_link eng selected" data-lang="en" data-placement="0">English</a></li>
    <li><a href="#" class="language_link ara" data-lang="ar" data-placement="1">Arabic</a></li>
    <li><a href="#" class="language_link spa" data-lang="es" data-placement="2">Spanish</a></li>
  </ul>
</div>

<!-- <div id="translation" class="mobile">
  <ul class="translation_links">
    <li><a href="#" class="language_link eng selected" data-lang="en" data-placement="0">En</a></li>
    <li><a href="#" class="language_link ara" data-lang="ar" data-placement="1">Ar</a></li>
    <li><a href="#" class="language_link spa" data-lang="es" data-placement="2">Sp</a></li>
  </ul>
</div> -->

<!-- Load Facebook SDK for JavaScript -->
<div id="fb-root"></div>

<!-- addeventListener to each language in the visible list -->
<script type="text/javascript">
  // get all the languages
  let languages = document.getElementsByClassName("language_link");
  for (let i = 0; i < languages.length; i++) {
    (function(index) {
      languages[index].addEventListener("click", function() {
        // go to hidden google translate dropdown
        let dropdown = document.getElementsByClassName("goog-te-menu-frame")[0].contentDocument;
        for (let j = 0; j < languages.length; j++) {
          if (languages[j].classList.contains("selected")) {
            languages[j].classList.remove("selected");
            break;
          }
        }
        languages[index].classList.add("selected");
        // click on the option that matches the index of the language clicked on
        dropdown.getElementsByTagName("a")[index].click();
        loadMessenger(index);
      })
    })(i);
  }

  function pageLanguage(index) {
    if (index === 0) {
      console.log("pageLanguage returned English");
      return 'https://connect.facebook.net/en_US/sdk/xfbml.customerchat.js?t='+ (new Date()).getTime();
    }

    else if (index === 1) {
      console.log("pageLanguage returned Arabic");
      return 'https://connect.facebook.net/ar_AR/sdk/xfbml.customerchat.js?t='+ (new Date()).getTime();
    }

    else {
      console.log("pageLanguage returned Spanish");
      return 'https://connect.facebook.net/es_LA/sdk/xfbml.customerchat.js?t='+ (new Date()).getTime();;
    }
  }
 
  window.fbAsyncInit = function() {
    FB.init({
      xfbml            : true,
      version          : 'v10.0'
    });
  }

  function loadMessenger (index) {
    let source = pageLanguage(index);
    (function(d, s, id) {
        let js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) {
          d.getElementById(id).remove();
          fjs = d.getElementsByTagName(s)[0];
        }
        js = d.createElement(s); 
        js.id = id;
        try {
            js.src = source;
        } catch (error) {
            js.src = 'https://connect.facebook.net/en_US/sdk/xfbml.customerchat.js?t=';
        }
        fjs.parentNode.insertBefore(js,fjs);
    }(document, 'script', 'facebook-jssdk'));
  }

  loadMessenger(0);
</script>

<!-- Your Chat Plugin code -->
<div class="fb-customerchat"
  attribution="setup_tool"
  page_id="1672244133057923"
theme_color="#962026"
logged_in_greeting="Hi! Want to talk to a organization member? Live chat hours are Mon-Fri 9am-5pm."
logged_out_greeting="Hi! Want to talk to a organization member? Live chat hours are Mon-Fri 9am-5pm.">
</div>




<!-- --------------------------------------------------------------------- -->

<!-- Trial Code for translating chat -->

<!-- <div id="google_translate_element"></div>
<ul id="translation" class="translation_links">
  <li><a href="#" class="language_link eng" data-lang="en" data-placement="0">English</a></li>
  <li><a href="#" class="language_link ara" data-lang="ar" data-placement="1">العربية</a></li>
  <li><a href="#" class="language_link spa" data-lang="es" data-placement="2">Español</a></li>
</ul> -->

<!-- Load Facebook SDK for JavaScript -->
<!-- <div id="fb-root"></div>
<script type="text/javascript">
      function readCookie(name) {
        let c = document.cookie.split('; '),
        cookies = {}, i, C;

        for (i = c.length - 1; i >= 0; i--) {
            C = c[i].split('=');
            cookies[C[0]] = C[1];
        }

        return cookies[name];
    }
  
  	function indexToCookie(i) {
      if (i === 1) {
        return 'ar';
      }
      else if (i === 2) {
        return 'es';
      }
      else {
        return 'en';
      }
      
    }
    function cookieToIndex(c) {
      let lang = c.substring(4);
      if (lang == "ar") {
        return 1;
      }
      else if (lang == "es") {
        return 2;
      }
      else {
        return 0;
      }   
    }
    let cookie = readCookie('googtrans');
	if (cookie == undefined) {
      console.log('cookie undefined');
      cookie = '/en/en';
    }
  let click_index; -->
// addeventListener to each language in the visible list

  // get all the languages
  let languages = document.getElementsByClassName("language_link");
  for (let i = 0; i < languages.length; i++) {
    (function(index) {
      languages[index].addEventListener("click", function() {
        let new_cookie = cookie;
        // go to hidden google translate dropdown
        let dropdown = document.getElementsByClassName("goog-te-menu-frame")[0].contentDocument;
        // click on the option that matches the index of the language clicked on
        dropdown.getElementsByTagName("a")[index].click();
        cookie = cookie.substring(0,4) + indexToCookie(index);
        new_cookie = cookie;
    
        console.log("old cookie: "+readCookie('googtrans')+"; new cookie: "+cookie);
        console.log("loading messenger from link click: "+ index);

        function reloadPage() {
            console.log("page reloaded");
			window.location.reload(true);
          	return false;
          }
        console.log("language_cookie before reload: "+cookie);
        click_index = index;
        loadMessenger(index);
        
        reloadPage();
        console.log("old index: "+click_index+"; new index: "+index);        

        console.log("language_cookie after reload: "+cookie);
          console.log("assigned googtrans: "+ cookie);
         document.cookie = "googtrans="+cookie;
      })
    })(i);
  }

  function pageLanguage(index) {
   // assign localization according to what language the page is translated to
    console.log("cookie in pageLanguage: "+ cookie);
    console.log("index in pageLanguage: "+ index);
    if (index == undefined) {
      index = cookieToIndex(cookie);
    }
    
          if (index === 1) {
      console.log("pageLanguage returned Arabic");
          	return 'https://connect.facebook.net/ar_AR/sdk/xfbml.customerchat.js?t='+ (new Date()).getTime();
    }

    else if (index === 2) {
      console.log("pageLanguage returned Spanish");
      'https://connect.facebook.net/es_LA/sdk/xfbml.customerchat.js?t='+ (new Date()).getTime();;
    }

    else {
      console.log("pageLanguage returned English");
      return 'https://connect.facebook.net/en_US/sdk/xfbml.customerchat.js?t='+ (new Date()).getTime();
    }
  } 
  
  window.fbAsyncInit = function(){
    console.log("FB initialized");
    FB.init({
      xfbml            : true,
      version          : 'v10.0'
  });
  };

  function loadMessenger (index) {
    let source = pageLanguage(index);
    (function(d, s, id) {
      	//let scripts_length = d.body.getElementsByTagName(s).length;
        let js, fjs = d.body.getElementsByTagName(s)[0];
        if (d.getElementById(id)) {
          d.getElementById(id).remove();
          fjs = d.getElementsByTagName(s)[0];
        }
        js = d.createElement(s); 
        js.id = id;
        try {
            js.src = source;
        } catch (error) {
            js.src = 'https://connect.facebook.net/en_US/sdk/xfbml.customerchat.js';
        }
        fjs.parentNode.insertBefore(js,fjs);
    }(document, 'script', 'facebook-jssdk'));
    console.log("language_cookie inside loadMessenger: "+ cookie);
  }
  console.log("running loadMessenger from end of script");
  loadMessenger();
<!-- </script> -->



<!-- Your Chat Plugin code -->
      <!-- <div class="fb-customerchat"
        attribution="setup_tool"
        page_id="102587671897031"
  theme_color="#962026"
  logged_in_greeting="Hi! Want to talk to a board member? We are available to chat Mon-Fri 9am-5pm."
  logged_out_greeting="Hi! Want to talk to a board member? We are available to chat Mon-Fri 9am-5pm.">
      </div> -->